System.register(["jimu-core","jimu-arcgis"],(function(e,t){var a={},o={};return{setters:[function(e){a.React=e.React,a.css=e.css,a.jsx=e.jsx},function(e){o.MapViewManager=e.MapViewManager,o.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules}],execute:function(){e((()=>{var e={244:e=>{"use strict";e.exports=a},686:e=>{"use strict";e.exports=o}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,s),i.exports}s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="";var i={};return s.p=window.jimuConfig.baseUrl,(()=>{"use strict";s.r(i),s.d(i,{__set_webpack_public_path__:()=>d,default:()=>c});var e=s(244),t=s(686);class a extends e.React.PureComponent{constructor(t){super(t),this.avatarOptions=[{emoji:"\u{1f468}\u{1f3fe}\u200d\u{1f33e}",name:"Jo\xe3o",profession:"Agricultor",professionEn:"Farmer"},{emoji:"\u{1f469}\u{1f3ff}\u200d\u{1f33e}",name:"Maria",profession:"Agricultora",professionEn:"Farmer"},{emoji:"\u{1f468}\u{1f3fd}\u200d\u{1f3ed}",name:"Pedro",profession:"Trabalhador",professionEn:"Worker"},{emoji:"\u{1f469}\u{1f3fe}\u200d\u{1f3ed}",name:"Ana",profession:"Trabalhadora",professionEn:"Worker"},{emoji:"\u{1f474}\u{1f3fd}",name:"Sr. Jos\xe9",profession:"Aposentado",professionEn:"Retired"},{emoji:"\u{1f475}\u{1f3fe}",name:"Dona Rosa",profession:"Aposentada",professionEn:"Retired"},{emoji:"\u{1f468}\u{1f3ff}\u200d\u{1f393}",name:"Carlos",profession:"Estudante",professionEn:"Student"},{emoji:"\u{1f469}\u{1f3fd}\u200d\u{1f393}",name:"J\xfalia",profession:"Estudante",professionEn:"Student"},{emoji:"\u{1f468}\u{1f3fe}\u200d\u{1f4bc}",name:"Roberto",profession:"Empreendedor",professionEn:"Entrepreneur"},{emoji:"\u{1f469}\u{1f3ff}\u200d\u{1f4bc}",name:"Beatriz",profession:"Empreendedora",professionEn:"Entrepreneur"},{emoji:"\u{1f9d1}\u{1f3fd}\u200d\u{1f9bd}",name:"Alex",profession:"Cidad\xe3o",professionEn:"Citizen"},{emoji:"\u{1f469}\u{1f3fe}\u200d\u{1f9af}",name:"Lucia",profession:"Cidad\xe3",professionEn:"Citizen"},{emoji:"\u{1f468}\u{1f3ff}\u200d\u{1f373}",name:"Miguel",profession:"Cozinheiro",professionEn:"Cook"},{emoji:"\u{1f469}\u{1f3fd}\u200d\u{1f373}",name:"Rita",profession:"Cozinheira",professionEn:"Cook"},{emoji:"\u{1f468}\u{1f3fe}\u200d\u2695\ufe0f",name:"Dr. Silva",profession:"M\xe9dico",professionEn:"Doctor"},{emoji:"\u{1f469}\u{1f3ff}\u200d\u2695\ufe0f",name:"Dra. Santos",profession:"M\xe9dica",professionEn:"Doctor"},{emoji:"\u{1f468}\u{1f3fd}\u200d\u{1f3eb}",name:"Prof. Lima",profession:"Professor",professionEn:"Teacher"},{emoji:"\u{1f469}\u{1f3fe}\u200d\u{1f3eb}",name:"Profa. Souza",profession:"Professora",professionEn:"Teacher"},{emoji:"\u{1f9d5}\u{1f3fd}",name:"Fatima",profession:"Cidad\xe3",professionEn:"Citizen"},{emoji:"\u{1f473}\u{1f3fe}\u200d\u2642\ufe0f",name:"Ahmed",profession:"Cidad\xe3o",professionEn:"Citizen"}],this.startAnimation=()=>{this.setState({isAnimating:!0}),setTimeout((()=>{this.setState({isAnimating:!1})}),2e3);const e=setInterval((()=>{this.setState({isAnimating:!0}),setTimeout((()=>{this.setState({isAnimating:!1})}),2e3)}),8e3);this.setState({animationInterval:e})},this.stopAnimation=()=>{this.state.animationInterval&&(clearInterval(this.state.animationInterval),this.setState({animationInterval:null,isAnimating:!1}))},this.loadPosition=()=>{try{const e=localStorage.getItem("chat-widget-position");return e?JSON.parse(e):null}catch(e){return null}},this.savePosition=e=>{try{localStorage.setItem("chat-widget-position",JSON.stringify(e))}catch(e){console.warn("N\xe3o foi poss\xedvel salvar a posi\xe7\xe3o",e)}},this.loadSize=()=>{try{const e=localStorage.getItem("chat-widget-size");return e?JSON.parse(e):null}catch(e){return null}},this.saveSize=e=>{try{localStorage.setItem("chat-widget-size",JSON.stringify(e))}catch(e){console.warn("N\xe3o foi poss\xedvel salvar o tamanho",e)}},this.handleMouseDown=e=>{var t;if(!this.state.isMinimized)return;e.preventDefault();const a=null===(t=this.minimizedRef.current)||void 0===t?void 0:t.getBoundingClientRect();a&&this.setState({isDragging:!0,hasMoved:!1,dragOffset:{x:e.clientX-a.left,y:e.clientY-a.top}})},this.handleHeaderMouseDown=e=>{var t;const a=e.target;if(a.closest("[data-no-drag]")||"BUTTON"===a.tagName)return;e.preventDefault();const o=null===(t=e.currentTarget.parentElement)||void 0===t?void 0:t.getBoundingClientRect();o&&this.setState({isDragging:!0,hasMoved:!1,dragOffset:{x:e.clientX-o.left,y:e.clientY-o.top}})},this.handleMouseMove=e=>{if(this.state.isDragging){const t=e.clientX-this.state.dragOffset.x,a=e.clientY-this.state.dragOffset.y,o=this.state.isMinimized?70:this.state.size.width,s=this.state.isMinimized?70:this.state.size.height,i=window.innerWidth-o,n=window.innerHeight-s,r=Math.max(0,Math.min(t,i)),l=Math.max(0,Math.min(a,n)),c=Math.abs(r-this.state.position.x),d=Math.abs(l-this.state.position.y);(c>5||d>5)&&this.setState({hasMoved:!0}),this.setState({position:{x:r,y:l}})}this.handleResizeMove(e)},this.handleMouseUp=()=>{this.state.isDragging&&(this.savePosition(this.state.position),this.setState({isDragging:!1})),this.handleResizeEnd()},this.handleResizeStart=e=>{e.preventDefault(),e.stopPropagation(),this.setState({isResizing:!0})},this.handleResizeMove=e=>{if(!this.state.isResizing)return;const t=document.querySelector("[data-widget-container]");if(!t)return;const a=t.getBoundingClientRect(),o=Math.max(350,Math.min(800,e.clientX-a.left)),s=Math.max(400,Math.min(900,e.clientY-a.top));this.setState({size:{width:o,height:s}})},this.handleResizeEnd=()=>{this.state.isResizing&&(this.saveSize(this.state.size),this.setState({isResizing:!1}))},this.scrollToBottom=()=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{this.messagesEndRef.current&&this.messagesEndRef.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}))}))},this.handleInputChange=e=>{this.setState({inputValue:e.target.value})},this.handleSend=()=>{const{inputValue:e}=this.state,{isProcessing:t,onSendMessage:a}=this.props;e.trim()&&!t&&(a(e.trim()),this.setState({inputValue:""}),setTimeout((()=>{var e;null===(e=this.inputRef.current)||void 0===e||e.focus()}),100))},this.handleKeyPress=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),this.handleSend())},this.handleSuggestionClick=e=>{this.setState({inputValue:e},(()=>{var e;null===(e=this.inputRef.current)||void 0===e||e.focus()}))},this.toggleMinimize=()=>{this.setState((e=>({isMinimized:!e.isMinimized})))},this.toggleAvatarSelector=()=>{this.setState((e=>({showAvatarSelector:!e.showAvatarSelector})))},this.selectAvatar=e=>{this.setState({showAvatarSelector:!1}),this.props.onAvatarChange&&this.props.onAvatarChange(e.emoji)},this.formatTimestamp=e=>{const{language:t}=this.props;return e.toLocaleTimeString("pt-BR"===t?"pt-BR":"en-US",{hour:"2-digit",minute:"2-digit"})},this.getAssistantAvatar=()=>this.props.selectedAvatar||"\u{1f468}\u{1f3fe}\u200d\u{1f4bc}",this.getUserAvatar=()=>{const e=["\u{1f64b}\u{1f3fe}\u200d\u2642\ufe0f","\u{1f64b}\u{1f3fd}\u200d\u2640\ufe0f","\u{1f64b}\u{1f3fb}\u200d\u2642\ufe0f","\u{1f64b}\u{1f3ff}\u200d\u2640\ufe0f","\u{1f64b}\u{1f3fc}\u200d\u2642\ufe0f","\u{1f64b}\u{1f3fe}\u200d\u2640\ufe0f"];return e[Math.floor(Date.now()/36e5)%e.length]},this.getSelectedAvatarInfo=()=>{const e=this.getAssistantAvatar();return this.avatarOptions.find((t=>t.emoji===e))||null};const a=this.loadPosition(),o=this.loadSize(),s=(window.innerWidth-400)/2,i=(window.innerHeight-600)/2;this.state={inputValue:"",isMinimized:!1,position:a||{x:s,y:i},isDragging:!1,dragOffset:{x:0,y:0},showAvatarSelector:!1,size:o||{width:400,height:600},isResizing:!1,hasMoved:!1,isAnimating:!1,animationInterval:null},this.messagesEndRef=e.React.createRef(),this.inputRef=e.React.createRef(),this.minimizedRef=e.React.createRef(),this.messagesAreaRef=e.React.createRef(),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this)}componentDidMount(){this.scrollToBottom(),window.addEventListener("mousemove",this.handleMouseMove,{passive:!1}),window.addEventListener("mouseup",this.handleMouseUp,{passive:!1})}componentWillUnmount(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp),this.stopAnimation()}componentDidUpdate(e,t){e.messages.length!==this.props.messages.length&&(this.scrollToBottom(),setTimeout((()=>{this.messagesAreaRef.current&&(this.messagesAreaRef.current.scrollTop=this.messagesAreaRef.current.scrollHeight)}),100)),t.isMinimized===this.state.isMinimized||this.state.isMinimized||setTimeout((()=>this.scrollToBottom()),100),e.isProcessing===this.props.isProcessing||this.props.isProcessing||setTimeout((()=>this.scrollToBottom()),200),!t.isMinimized&&this.state.isMinimized&&this.startAnimation(),t.isMinimized&&!this.state.isMinimized&&this.stopAnimation()}getStyles(){const{position:t,isDragging:a,size:o,isResizing:s,isAnimating:i}=this.state;return{container:e.css`
      display: flex;
      flex-direction: column;
      width: ${o.width}px;
      height: ${o.height}px;
      position: fixed;
      top: ${t.y}px;
      left: ${t.x}px;
      
      /* Design claro e acolhedor */
      background: linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%);
      border: 2px solid #e9ecef;
      box-shadow: 
        0 10px 40px rgba(0, 0, 0, 0.1),
        0 2px 8px rgba(0, 0, 0, 0.05);
      
      border-radius: 16px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Open Sans', sans-serif;
      overflow: hidden;
      cursor: ${s?"nwse-resize":"default"};
      z-index: 9998;
      user-select: ${s||a?"none":"auto"};
      
      /* Detalhe sutil da bandeira brasileira */
      &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #28a745 0%, #ffc107 50%, #0066cc 100%);
        opacity: 0.8;
      }
    `,resizeHandle:e.css`
      position: absolute;
      bottom: 0;
      right: 0;
      width: 24px;
      height: 24px;
      cursor: nwse-resize;
      z-index: 1001;
      &::before {
        content: '';
        position: absolute;
        bottom: 4px;
        right: 4px;
        width: 12px;
        height: 12px;
        border-right: 3px solid rgba(0, 102, 204, 0.3);
        border-bottom: 3px solid rgba(0, 102, 204, 0.3);
        border-radius: 0 0 3px 0;
      }
      &:hover::before { border-color: #0066cc; }
    `,minimizedContainer:e.css`
      position: fixed;
      left: ${t.x}px;
      top: ${t.y}px;
      z-index: 9999;
      cursor: ${a?"grabbing":"grab"};
      user-select: none;
    `,minimizedAvatar:e.css`
      width: 70px;
      height: 70px;
      border-radius: 50%;
      
      /* Gradiente democrático */
      background: linear-gradient(135deg, #28a745 0%, #0066cc 100%);
      
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      
      box-shadow: 
        0 4px 20px rgba(0, 102, 204, 0.3),
        0 0 0 4px #ffffff,
        0 0 0 6px rgba(0, 102, 204, 0.2);
      
      transition: ${a?"none":"all 0.3s ease"};
      position: relative;
      
      ${i&&e.css`
        animation: 
          avatarWaveNew 2s ease-in-out,
          avatarPulseNew 2s ease-in-out,
          avatarRingNew 2s ease-out;
      `}
      
      &:hover {
        transform: ${a?"scale(1)":"scale(1.08)"};
        box-shadow: 
          0 8px 30px rgba(0, 102, 204, 0.4),
          0 0 0 4px #ffffff,
          0 0 0 6px rgba(0, 102, 204, 0.3);
        animation-play-state: paused;
      }
      
      @keyframes avatarWaveNew { 0%, 100% { transform: rotate(0deg) scale(1); } 10% { transform: rotate(-12deg) scale(1.05); } 20% { transform: rotate(12deg) scale(1.05); } 30% { transform: rotate(-12deg) scale(1.05); } 40% { transform: rotate(12deg) scale(1.05); } 50% { transform: rotate(0deg) scale(1); } }
      @keyframes avatarPulseNew { 0%, 100% { opacity: 1; } 50% { opacity: 0.9; } }
      @keyframes avatarRingNew { 0% { box-shadow: 0 4px 20px rgba(0, 102, 204, 0.3), 0 0 0 4px #ffffff, 0 0 0 6px rgba(0, 102, 204, 0.6); } 100% { box-shadow: 0 4px 20px rgba(0, 102, 204, 0.3), 0 0 0 4px #ffffff, 0 0 0 25px rgba(0, 102, 204, 0); } }
    `,header:e.css`
      background: linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%);
      padding: 18px 24px;
      border-bottom: 2px solid #e9ecef;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: relative;
      z-index: 10;
      cursor: grab;
      
      &:active { cursor: grabbing; }
      
      /* Barra colorida suave */
      &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #28a745 0%, #ffc107 50%, #0066cc 100%);
        opacity: 0.8;
      }
    `,headerLeft:e.css`display: flex; align-items: center; gap: 16px; flex: 1; min-width: 0;`,avatarSquare:e.css`
      width: 52px;
      height: 52px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      
      /* Avatar circular para mais humanização */
      border-radius: 50%;
      
      background: linear-gradient(135deg, #28a745 0%, #0066cc 100%);
      
      box-shadow: 
        0 4px 12px rgba(0, 102, 204, 0.2),
        0 0 0 3px #ffffff,
        0 0 0 4px rgba(0, 102, 204, 0.15);
      
      cursor: pointer;
      transition: all 0.3s ease;
      flex-shrink: 0;
      
      &:hover {
        transform: scale(1.05);
        box-shadow: 
          0 6px 20px rgba(0, 102, 204, 0.3),
          0 0 0 3px #ffffff,
          0 0 0 5px rgba(0, 102, 204, 0.25);
      }
    `,avatarBadge:e.css`
      position: absolute;
      bottom: -2px;
      right: -2px;
      background: #28a745;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      border: 3px solid #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
    `,avatarSelectorModal:e.css`
      position: absolute;
      top: 85px;
      left: 24px;
      background: #ffffff;
      border: 2px solid #e9ecef;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      z-index: 1000;
      max-width: 400px;
      animation: slideDown 0.3s ease-out;
      @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    `,avatarSelectorTitle:e.css`color: #212529; font-size: 16px; font-weight: 700; margin: 0 0 20px 0; display: flex; align-items: center; gap: 10px;`,avatarGrid:e.css`
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      max-height: 320px;
      overflow-y: auto;
      &::-webkit-scrollbar { width: 8px; }
      &::-webkit-scrollbar-track { background: #f8f9fa; border-radius: 4px; }
      &::-webkit-scrollbar-thumb { background: #dee2e6; border-radius: 4px; }
      &::-webkit-scrollbar-thumb:hover { background: #adb5bd; }
    `,avatarOption:e.css`
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      padding: 14px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      &:hover {
        background: #e9ecef;
        border-color: #0066cc;
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 102, 204, 0.15);
      }
    `,avatarOptionEmoji:e.css`font-size: 32px;`,avatarOptionName:e.css`color: #212529; font-size: 11px; font-weight: 700; text-align: center; line-height: 1.3;`,avatarOptionProf:e.css`color: #6c757d; font-size: 10px; text-align: center; font-weight: 500;`,headerInfo:e.css`display: flex; flex-direction: column; min-width: 0; flex: 1;`,headerTitle:e.css`color: #212529; margin: 0 0 6px 0; font-size: 17px; font-weight: 700; line-height: 1.3;`,headerSubtitle:e.css`color: #6c757d; margin: 0; font-size: 13px; font-weight: 500; display: flex; align-items: center; gap: 8px;`,headerProfession:e.css`color: #0066cc; font-size: 12px; font-weight: 600; margin-top: 4px; display: flex; align-items: center; gap: 6px;`,headerActions:e.css`display: flex; align-items: center; gap: 10px; flex-shrink: 0;`,actionButton:e.css`
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      color: #495057;
      width: 42px;
      height: 42px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 600;
      &:hover:not(:disabled) {
        background: #0066cc;
        border-color: #0066cc;
        color: #ffffff;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 102, 204, 0.2);
      }
      &:active:not(:disabled) { transform: translateY(0); }
      &:disabled { opacity: 0.4; cursor: not-allowed; }
    `,minimizeButton:e.css`
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      color: #495057;
      width: 42px;
      height: 42px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      &:hover { background: #0066cc; border-color: #0066cc; color: #ffffff; box-shadow: 0 4px 12px rgba(0, 102, 204, 0.2); }
    `,deleteButton:e.css`background: #fff5f5; border-color: #fecaca; color: #dc2626; &:hover:not(:disabled) { background: #dc2626; border-color: #dc2626; color: #ffffff; box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2); }`,infoButton:e.css`background: #f0f9ff; border-color: #bfdbfe; color: #0066cc; &:hover:not(:disabled) { background: #0066cc; border-color: #0066cc; color: #ffffff; box-shadow: 0 4px 12px rgba(0, 102, 204, 0.2); }`,languageButton:e.css`background: #f8f9fa; border: 2px solid #e9ecef; width: 46px; border-radius: 10px; &:hover:not(:disabled) { background: #0066cc; border-color: #0066cc; box-shadow: 0 4px 12px rgba(0, 102, 204, 0.2); }`,statusIndicator:e.css`width: 10px; height: 10px; background: #28a745; border-radius: 50%; box-shadow: 0 0 10px rgba(40, 167, 69, 0.5); animation: statusPulse 2s ease-in-out infinite; @keyframes statusPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }`,messagesArea:e.css`
      flex: 1;
      overflow-y: auto;
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      background: #ffffff;
      &::-webkit-scrollbar { width: 10px; }
      &::-webkit-scrollbar-track { background: #f8f9fa; }
      &::-webkit-scrollbar-thumb { background: #dee2e6; border-radius: 5px; }
      &::-webkit-scrollbar-thumb:hover { background: #adb5bd; }
    `,messageContainer:e.css`display: flex; gap: 14px; align-items: flex-start; animation: slideInLeft 0.3s ease-out; @keyframes slideInLeft { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }`,messageContainerUser:e.css`display: flex; gap: 14px; align-items: flex-start; flex-direction: row-reverse; animation: slideInRight 0.3s ease-out; @keyframes slideInRight { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }`,messageAvatar:e.css`width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 20px; border: 2px solid #ffffff; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);`,messageAvatarBot:e.css`background: linear-gradient(135deg, #28a745 0%, #0066cc 100%);`,messageAvatarUser:e.css`background: linear-gradient(135deg, #0066cc 0%, #fd7e14 100%);`,messageContent:e.css`flex: 1; display: flex; flex-direction: column; max-width: 75%;`,messageContentUser:e.css`flex: 1; display: flex; flex-direction: column; align-items: flex-end; max-width: 75%;`,messageBubble:e.css`padding: 14px 18px; border-radius: 16px; word-wrap: break-word; white-space: pre-wrap; line-height: 1.6; font-size: 14px; font-weight: 400;`,messageBubbleBot:e.css`background: #f8f9fa; color: #212529; border: 1px solid #e9ecef; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);`,messageBubbleUser:e.css`background: linear-gradient(135deg, #0066cc 0%, #0052a3 100%); color: #ffffff; box-shadow: 0 2px 12px rgba(0, 102, 204, 0.25);`,messageTimestamp:e.css`font-size: 11px; color: #adb5bd; margin-top: 6px; padding: 0 6px; font-weight: 500;`,processingIndicator:e.css`display: flex; align-items: center; gap: 12px; padding: 14px 18px; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 16px; align-self: flex-start;`,dot:e.css`width: 10px; height: 10px; background: #0066cc; border-radius: 50%; animation: bounce 1.4s infinite ease-in-out; @keyframes bounce { 0%, 80%, 100% { transform: scale(0); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } } &:nth-of-type(1) { animation-delay: -0.32s; } &:nth-of-type(2) { animation-delay: -0.16s; }`,suggestionsContainer:e.css`padding: 20px 24px; background: #f8f9fa; border-top: 2px solid #e9ecef;`,suggestionsTitle:e.css`font-size: 12px; color: #6c757d; margin: 0 0 14px 0; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;`,suggestionsWrapper:e.css`display: flex; flex-wrap: wrap; gap: 10px;`,suggestionButton:e.css`background: #ffffff; border: 2px solid #e9ecef; color: #495057; padding: 10px 16px; border-radius: 20px; font-size: 13px; cursor: pointer; transition: all 0.2s; font-weight: 600; &:hover:not(:disabled) { background: #0066cc; border-color: #0066cc; color: #ffffff; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 102, 204, 0.2); } &:active:not(:disabled) { transform: translateY(0); } &:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }`,inputArea:e.css`padding: 20px 24px; background: #ffffff; border-top: 2px solid #e9ecef;`,inputWrapper:e.css`display: flex; gap: 12px; align-items: center;`,input:e.css`flex: 1; padding: 14px 18px; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 12px; color: #212529; font-size: 14px; outline: none; transition: all 0.2s; &:focus { border-color: #0066cc; background: #ffffff; box-shadow: 0 0 0 4px rgba(0, 102, 204, 0.1); } &::placeholder { color: #adb5bd; } &:disabled { opacity: 0.5; cursor: not-allowed; }`,clearFiltersInputButton:e.css`background: #fff5f5; border: 2px solid #fecaca; border-radius: 50%; color: #dc2626; width: 44px; height: 44px; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; font-size: 18px; flex-shrink: 0; &:hover:not(:disabled) { background: #dc2626; border-color: #dc2626; color: #ffffff; transform: scale(1.05); box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2); } &:active:not(:disabled) { transform: scale(1); } &:disabled { opacity: 0.4; cursor: not-allowed; }`,sendButton:e.css`background: linear-gradient(135deg, #28a745 0%, #0066cc 100%); border: none; color: #ffffff; width: 52px; height: 52px; border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 22px; font-weight: 700; position: relative; overflow: hidden; box-shadow: 0 4px 16px rgba(0, 102, 204, 0.3); flex-shrink: 0; transition: all 0.2s; &:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 8px 24px rgba(0, 102, 204, 0.4); } &:active:not(:disabled) { transform: translateY(-1px); } &:disabled { opacity: 0.4; cursor: not-allowed; transform: scale(1); }`}}render(){const{messages:t,isProcessing:a,showSuggestions:o,language:s,hasActiveFilter:i,onClearFilters:n,suggestedCommands:r,onLanguageChange:l}=this.props,{inputValue:c,isMinimized:d,showAvatarSelector:u}=this.state,p=this.getStyles();if(d)return(0,e.jsx)("div",{ref:this.minimizedRef,css:p.minimizedContainer,onMouseDown:this.handleMouseDown,onClick:e=>{this.state.hasMoved||this.toggleMinimize()}},(0,e.jsx)("div",{css:p.minimizedAvatar,title:"pt-BR"===s?"Arraste para mover ou clique para abrir":"Drag to move or click to open"},this.getAssistantAvatar()));const g=r||["pt-BR"===s?"Liste as categorias":"List categories","pt-BR"===s?"Mostre apenas oficinas":"Show only workshops","pt-BR"===s?"Qual o total de p\xfablico?":"What is the total audience?","pt-BR"===s?"Remover filtros":"Remove filters"],h=this.getSelectedAvatarInfo();return(0,e.jsx)("div",{css:p.container,"data-widget-container":!0},(0,e.jsx)("div",{css:p.resizeHandle,onMouseDown:this.handleResizeStart,title:"pt-BR"===s?"Arraste para redimensionar":"Drag to resize"}),(0,e.jsx)("div",{css:p.header,onMouseDown:this.handleHeaderMouseDown,title:"pt-BR"===s?"Arraste para mover":"Drag to move"},(0,e.jsx)("div",{css:p.headerLeft},(0,e.jsx)("div",{css:p.avatarSquare,onClick:this.toggleAvatarSelector,"data-no-drag":!0},this.getAssistantAvatar(),(0,e.jsx)("div",{css:p.avatarBadge},"\u270f\ufe0f")),(0,e.jsx)("div",{css:p.headerInfo},(0,e.jsx)("h1",{css:p.headerTitle},"pt-BR"===s?"Assistente Democr\xe1tico":"Democratic Assistant"),(0,e.jsx)("p",{css:p.headerSubtitle},(0,e.jsx)("span",{css:p.statusIndicator}),"pt-BR"===s?"Participa\xe7\xe3o Social":"Social Participation"),h&&(0,e.jsx)("p",{css:p.headerProfession},"\u{1f4bc} ",h.name," \u2022 ","pt-BR"===s?h.profession:h.professionEn))),(0,e.jsx)("div",{css:p.headerActions,"data-no-drag":!0},(0,e.jsx)("button",{css:p.minimizeButton,onClick:this.toggleMinimize,disabled:a,title:"pt-BR"===s?"Minimizar":"Minimize"},"\u2796"),(0,e.jsx)("button",{css:[p.actionButton,p.infoButton],onClick:()=>this.props.onSendMessage("pt-BR"===s?"ajuda":"help"),disabled:a,title:"pt-BR"===s?"Como usar":"How to use"},"\u2753"),l&&(0,e.jsx)("button",{css:[p.actionButton,p.languageButton],onClick:()=>{l("pt-BR"===s?"en":"pt-BR")},disabled:a,title:"pt-BR"===s?"Switch to English":"Mudar para Portugu\xeas"},(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"3px"}},"pt-BR"===s?(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)("img",{src:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 30'%3E%3Cpath fill='%23b22234' d='M0 0h60v30H0z'/%3E%3Cpath stroke='%23fff' stroke-width='2.3' d='M0 2.3h60m0 4.6H0m0 4.6h60m0 4.6H0m0 4.6h60m0 4.6H0'/%3E%3Cpath fill='%233c3b6e' d='M0 0h24v16.5H0z'/%3E%3Cg fill='%23fff'%3E%3Cpath d='m3.7 2.8.5 1.5h1.6l-1.3 1-.5 1.5-1.3-1-1.3 1 .5-1.5-1.3-1h1.6l.5-1.5zm6 0 .5 1.5h1.6l-1.3 1-.5 1.5-1.3-1-1.3 1 .5-1.5-1.3-1h1.6l.5-1.5zm6 0 .5 1.5h1.6l-1.3 1-.5 1.5-1.3-1-1.3 1 .5-1.5-1.3-1h1.6l.5-1.5zm6 0 .5 1.5h1.6l-1.3 1-.5 1.5-1.3-1-1.3 1 .5-1.5-1.3-1h1.6l.5-1.5zm-15 5.5.5 1.5h1.6l-1.3 1-.5 1.5-1.3-1-1.3 1 .5-1.5-1.3-1h1.6l.5-1.5zm6 0 .5 1.5h1.6l-1.3 1-.5 1.5-1.3-1-1.3 1 .5-1.5-1.3-1h1.6l.5-1.5zm6 0 .5 1.5h1.6l-1.3 1-.5 1.5-1.3-1-1.3 1 .5-1.5-1.3-1h1.6l.5-1.5z'/%3E%3C/g%3E%3C/svg%3E",alt:"USA",style:{width:"28px",height:"18px",borderRadius:"3px",border:"1px solid rgba(0,0,0,0.1)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),(0,e.jsx)("span",{style:{fontSize:"9px",fontWeight:"700",color:"#1e293b",lineHeight:"1"}},"USA")):(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)("img",{src:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 42'%3E%3Cpath fill='%23009739' d='M0 0h60v42H0z'/%3E%3Cpath fill='%23FEDD00' d='M30 3.5 52.5 21 30 38.5 7.5 21z'/%3E%3Ccircle cx='30' cy='21' r='7' fill='%23012169'/%3E%3Cpath fill='none' stroke='%23fff' stroke-width='1.5' d='M21.8 18.5c1.5 1.2 3.5 2 5.7 2.3'/%3E%3C/svg%3E",alt:"Brasil",style:{width:"28px",height:"18px",borderRadius:"3px",border:"1px solid rgba(0,0,0,0.1)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),(0,e.jsx)("span",{style:{fontSize:"9px",fontWeight:"700",color:"#1e293b",lineHeight:"1"}},"BRA")))))),u&&(0,e.jsx)("div",{css:p.avatarSelectorModal},(0,e.jsx)("h3",{css:p.avatarSelectorTitle},"\u{1f465} ","pt-BR"===s?"Escolha seu representante":"Choose your representative"),(0,e.jsx)("div",{css:p.avatarGrid},this.avatarOptions.map(((t,a)=>(0,e.jsx)("div",{key:a,css:p.avatarOption,onClick:()=>this.selectAvatar(t),title:`${t.name} - ${"pt-BR"===s?t.profession:t.professionEn}`},(0,e.jsx)("div",{css:p.avatarOptionEmoji},t.emoji),(0,e.jsx)("div",{css:p.avatarOptionName},t.name),(0,e.jsx)("div",{css:p.avatarOptionProf},"pt-BR"===s?t.profession:t.professionEn)))))),(0,e.jsx)("div",{ref:this.messagesAreaRef,css:p.messagesArea,"data-messages-area":!0},t.map((t=>(0,e.jsx)("div",{key:t.id,css:"user"===t.type?p.messageContainerUser:p.messageContainer},(0,e.jsx)("div",{css:[p.messageAvatar,"bot"===t.type?p.messageAvatarBot:p.messageAvatarUser]},"bot"===t.type?this.getAssistantAvatar():this.getUserAvatar()),(0,e.jsx)("div",{css:"user"===t.type?p.messageContentUser:p.messageContent},(0,e.jsx)("div",{css:[p.messageBubble,"bot"===t.type?p.messageBubbleBot:p.messageBubbleUser]},t.content),(0,e.jsx)("div",{css:p.messageTimestamp},this.formatTimestamp(t.timestamp)))))),a&&(0,e.jsx)("div",{css:p.processingIndicator},(0,e.jsx)("span",{css:p.dot}),(0,e.jsx)("span",{css:p.dot}),(0,e.jsx)("span",{css:p.dot})),(0,e.jsx)("div",{ref:this.messagesEndRef})),o&&!a&&(0,e.jsx)("div",{css:p.suggestionsContainer},(0,e.jsx)("h3",{css:p.suggestionsTitle},"pt-BR"===s?"\u{1f4ac} Converse comigo":"\u{1f4ac} Talk to me"),(0,e.jsx)("div",{css:p.suggestionsWrapper},g.map(((t,o)=>(0,e.jsx)("button",{key:o,css:p.suggestionButton,onClick:()=>this.handleSuggestionClick(t),disabled:a},t))))),(0,e.jsx)("div",{css:p.inputArea},(0,e.jsx)("div",{css:p.inputWrapper},(0,e.jsx)("input",{ref:this.inputRef,css:p.input,type:"text",value:c,onChange:this.handleInputChange,onKeyPress:this.handleKeyPress,placeholder:"pt-BR"===s?"Converse naturalmente comigo...":"Talk naturally to me...",disabled:a}),i&&(0,e.jsx)("button",{css:p.clearFiltersInputButton,onClick:n,disabled:a,title:"pt-BR"===s?"Limpar filtros":"Clear filters"},"\u{1f5d1}\ufe0f"),(0,e.jsx)("button",{css:p.sendButton,onClick:this.handleSend,disabled:a||!c.trim(),title:"pt-BR"===s?"Enviar":"Send"},"\u27a4"))))}}class o{constructor(e="pt-BR"){this.language=e}analyzeIntent(e,t){const a=e.toLowerCase().trim();console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("\u{1f9e0} AN\xc1LISE DE INTEN\xc7\xc3O"),console.log("\u{1f4dd} Texto:",a),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550");const o=a.replace(/^(ola|oi|ol\xe1|hey|hi|hello|bom dia|boa tarde|boa noite)[,\s]*/i,"").replace(/^(por favor|please)[,\s]*/i,"").trim(),s=o.length>0&&o!==a,i=s?o:a;if(this.matchesHelp(a))return console.log("\u2705 Retornando: HELP"),{type:"HELP",params:{}};if(this.matchesReset(a))return console.log("\u2705 Retornando: RESET"),{type:"RESET",params:{}};const n=this.matchesCalculate(i,t);if(n)return console.log("\u2705 Retornando: CALCULATE"),n;const r=this.matchesList(i,t);if(r)return console.log("\u2705 Retornando: LIST"),r;const l=this.matchesFilter(i,t);return l?(console.log("\u2705 Retornando: FILTER"),l):this.matchesGreeting(a)&&!s?(console.log("\u2705 Retornando: GREETING"),{type:"GREETING",params:{}}):(console.log("\u274c Retornando: UNKNOWN"),{type:"UNKNOWN",params:{}})}matchesGreeting(e){return["ol\xe1","ola","oi","hey","e a\xed","eai","bom dia","boa tarde","boa noite","hello","hi","good morning","good afternoon","good evening"].some((t=>e.includes(t)))}matchesHelp(e){return[/\bajuda\b/i,/\bhelp\b/i,/\bcomandos\b/i,/\bcommands\b/i,/^(como|how)\s+(posso|can|do|funciona|trabalha|usar|use)/i,/o\s+que\s+(posso|voc\xea|pode)/i,/what\s+(can|do|are)\s+(you|i)/i].some((t=>t.test(e)))}matchesReset(e){return["remov","limp","tir","reset","clear","sem filtro","todos","tudo","geral","cancelar","voltar","desfazer"].some((t=>e.includes(t)))}matchesCalculate(e,t){const a=t.find((e=>e.name.toLowerCase().includes("public")||e.name.toLowerCase().includes("p_blic")||e.alias.toLowerCase().includes("p\xfablico"))),o=e.match(/(?:quantas|quantos)\s+(?:pessoas|participantes|cidad[a\xe3]os)\s+(?:participaram|estiveram|foram)\s+(?:das?|nos?|nas?|em)\s+(confer\xeancias?|oficinas?|reuni[\xf5o]es?|visitas?\s+t\xe9cnicas?|workshops?)/i);if(o&&o[1]&&a){let e=this.cleanCategoryName(o[1].trim());return e=this.normalizeCategoryName(e),console.log("\u2705 INTEN\xc7\xc3O: Somar p\xfablico filtrado por categoria \u2192",e),{type:"CALCULATE_FILTERED",params:{operation:"SUM",field:a.name,fieldAlias:a.alias,filterField:"categoria",filterValue:e}}}if(e.match(/(?:quantas|quantos)\s+(?:pessoas|participantes|cidad[a\xe3]os)/i)&&a)return console.log("\u2705 INTEN\xc7\xc3O: Somar TODO o p\xfablico"),{type:"CALCULATE",params:{operation:"SUM",field:a.name,fieldAlias:a.alias}};if(e.match(/\b(m[e\xe9]dia|medio|m[e\xe9]dio|average)\b/i)&&a)return console.log("\u2705 INTEN\xc7\xc3O: M\xe9dia de p\xfablico"),{type:"CALCULATE",params:{operation:"AVG",field:a.name,fieldAlias:a.alias}};if(e.match(/\b(total|sum|soma)\b/i)&&a)return console.log("\u2705 INTEN\xc7\xc3O: Somar TODO o p\xfablico"),{type:"CALCULATE",params:{operation:"SUM",field:a.name,fieldAlias:a.alias}};if(e.match(/^(?:quantos|quantas|quantidade|count|how many)\s/i)&&!e.match(/(?:pessoas|participantes|cidad[a\xe3]os)/i))return console.log("\u2705 INTEN\xc7\xc3O: Contar eventos"),{type:"CALCULATE",params:{operation:"COUNT",field:"*"}};if(e.match(/\b(maior|m[a\xe1]ximo|maximo|max|maximum|largest)\b/i)&&a)return console.log("\u2705 INTEN\xc7\xc3O: Maior p\xfablico"),{type:"CALCULATE",params:{operation:"MAX",field:a.name,fieldAlias:a.alias}};if(e.match(/\b(menor|m[i\xed]nimo|minimo|min|minimum|smallest)\b/i)&&a)return console.log("\u2705 INTEN\xc7\xc3O: Menor p\xfablico"),{type:"CALCULATE",params:{operation:"MIN",field:a.name,fieldAlias:a.alias}};const s=e.match(/(?:qual|quanto|what)\s+(?:o\s+)?(?:p[u\xfa]blico\s+|audience\s+)?(?:total|estimado|estimated)\s+(?:de\s+p[u\xfa]blico\s+|of audience\s+)?(?:da|das|dos|de|of|for)\s+(?:categoria\s+|category\s+)?([a-z\xe0-\xfa\s]+?)(?:\?|$)/i);if(s&&s[1]&&a){let e=this.cleanCategoryName(s[1].trim());return e=this.normalizeCategoryName(e),console.log("\u2705 INTEN\xc7\xc3O: Somar p\xfablico filtrado por categoria \u2192",e),{type:"CALCULATE_FILTERED",params:{operation:"SUM",field:a.name,fieldAlias:a.alias,filterField:"categoria",filterValue:e}}}return null}matchesList(e,t){if(!e.match(/(?:mostre|liste|show|list)\s+(?:as|os|todas|todos|the|all)?\s*(?:categoria|tipo|categories|types)/i))return console.log("\u26a0\ufe0f N\xe3o \xe9 listagem"),null;console.log("\u2705 INTEN\xc7\xc3O: Listar valores");let a=null;if(e.match(/categoria|tipo|evento|category|type|event/i)&&(a=t.find((e=>e.name.toLowerCase().includes("categoria")||e.name.toLowerCase().includes("tipo")))),a)return console.log("\u{1f4c2} Campo encontrado:",a.name),console.log("\u2705 Retornando LIST com:",{field:a.name,fieldAlias:a.alias}),{type:"LIST",params:{field:a.name,fieldAlias:a.alias}};if(console.log("\u26a0\ufe0f Campo n\xe3o encontrado, tentando primeiro campo dispon\xedvel"),t.length>0){const e=t.find((e=>e.name.toLowerCase().includes("categoria")||e.name.toLowerCase().includes("tipo")||e.name.toLowerCase().includes("category")||e.name.toLowerCase().includes("type")));if(e)return console.log("\u{1f4c2} Usando fallback:",e.name),{type:"LIST",params:{field:e.name,fieldAlias:e.alias}}}return console.log("\u274c matchesList retornando null (sem campo dispon\xedvel)"),null}removeStopwords(e){const t=["rapidamente","r\xe1pido","devagar","urgente","urg\xeancia","quickly","fast","slow","urgent","urgency","muito","bem","bastante","demais","pouco","very","quite","too","enough","little","agora","j\xe1","depois","amanh\xe3","hoje","now","already","later","tomorrow","today","por favor","please","obrigado","thanks","ent\xe3o","assim","portanto","logo","so","thus","therefore"];let a=e;for(const e of t){const t=new RegExp(`\\b${e}\\b`,"gi");a=a.replace(t," ")}return a.replace(/\s+/g," ").trim()}detectNegation(e){const t=[/(?:menos|exceto|tirando|sem|fora)\s+(?:as?|os?)?\s*(\w+)/gi,/(?:except|without|excluding|but not)\s+(?:the)?\s*(\w+)/gi];let a=!1;const o=[];for(const s of t){const t=e.matchAll(s);for(const e of t)a=!0,e[1]&&o.push(e[1].toLowerCase())}return{hasNegation:a,negatedCategories:o}}matchesFilter(e,t){console.log("\u{1f50d} Verificando FILTRO...");let a=e.replace(/^(ola|oi|ol\xe1|hey|hi|hello|bom dia|boa tarde|boa noite)[,\s]*/i,"").replace(/^(por favor|please)[,\s]*/i,"").trim();a=this.removeStopwords(a),console.log("\u{1f9f9} Texto limpo (sem stopwords):",a);const{hasNegation:o,negatedCategories:s}=this.detectNegation(a);o&&console.log("\u{1f6ab} Nega\xe7\xe3o detectada! Categorias exclu\xeddas:",s);const i=["filtr","mostr","apen","soment","busca","procur","exib","selecio","apenas","so","display","ver","quero"].some((e=>a.includes(e))),n=this.extractCategories(a);console.log("\u{1f4cb} Categorias encontradas:",n);const r=t.find((e=>e.name.toLowerCase().includes("categoria")||"tipo"===e.name.toLowerCase()));if(!r)return console.log("\u274c Campo categoria n\xe3o encontrado"),null;if(o&&s.length>0){console.log("\u2705 INTEN\xc7\xc3O: Filtrar com nega\xe7\xe3o (excluir categorias)");const e=s.map((e=>{const t=this.extractCategories(e);return t.length>0?this.normalizeCategoryName(t[0]):this.normalizeCategoryName(e)}));return{type:"FILTER",params:{field:r.name,fieldAlias:r.alias,values:e,operator:"NOT_IN",logicalOperator:"AND"}}}if(n.length>1){console.log("\u2705 INTEN\xc7\xc3O: Filtrar m\xfaltiplas categorias");const e=n.map((e=>this.normalizeCategoryName(e)));return console.log("\u{1f517} Operador l\xf3gico: OR (mostrar qualquer uma das categorias)"),{type:"FILTER",params:{field:r.name,fieldAlias:r.alias,values:e,operator:"IN",logicalOperator:"OR"}}}if((i||n.length>0)&&1===n.length){console.log("\u2705 INTEN\xc7\xc3O: Filtrar categoria \xfanica");const e=n[0],t=this.normalizeCategoryName(e);return console.log("\u{1f48e} Valor final normalizado:",t),{type:"FILTER",params:{field:r.name,fieldAlias:r.alias||r.name,value:t,operator:"LIKE"}}}const l=a.split(/\s+/).length;if(n.length>0&&l<=2){console.log("\u2705 INTEN\xc7\xc3O: Filtrar (comando direto)");const e=n[0],t=this.normalizeCategoryName(e);return{type:"FILTER",params:{field:r.name,fieldAlias:r.alias,value:t,operator:"LIKE"}}}if(i){console.log("\u{1f50d} Tem palavra-chave, extraindo valor...");const e=this.extractFilterValue(a);if(e){const t=this.normalizeCategoryName(e);return console.log("\u2705 INTEN\xc7\xc3O: Filtrar (busca gen\xe9rica)"),{type:"FILTER",params:{field:r.name,fieldAlias:r.alias,value:t,operator:"LIKE"}}}}return console.log("\u274c Sem inten\xe7\xe3o de filtro"),null}extractCategories(e){const t=[],a=e.toLowerCase(),o={reuni\u00e3o:["reuniao","reunioes","reuni\xf5es","reuni\xe3o","meeting","meetings"],oficina:["oficina","oficinas","workshop","workshops"],exposi\u00e7\u00e3o:["exposicao","exposi\xe7ao","exposi\xe7\xf5es","exposicoes","exposi\xe7\xe3o","exhibition","exhibitions"],plen\u00e1ria:["plenaria","plenarias","plen\xe1rias","plen\xe1ria","plenary","plenaries"],visita:["visita","visitas","visita t\xe9cnica","visitas t\xe9cnicas","visita tecnica","visitas tecnicas","visit","visits","technical visit","technical visits"],semin\u00e1rio:["seminario","seminarios","semin\xe1rios","semin\xe1rio","seminar","seminars"],palestra:["palestra","palestras","lecture","lectures","talk","talks"],debate:["debate","debates"],confer\u00eancia:["conferencia","conferencias","confer\xeancias","confer\xeancia","conference","conferences"],audi\u00eancia:["audiencia","audiencias","audi\xeancias","audi\xeancia","hearing","hearings"],consulta:["consulta","consultas","consultation","consultations"],f\u00f3rum:["forum","foruns","f\xf3rum","f\xf3runs","forums"],curso:["curso","cursos","course","courses"],encontro:["encontro","encontros","gathering","gatherings","meetup","meetups"]};for(const[e,s]of Object.entries(o))for(const o of s)if(o.includes(" ")&&a.includes(o)){t.includes(e)||t.push(e);break}for(const[e,s]of Object.entries(o))for(const o of s)if(!o.includes(" ")){const s=o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(new RegExp(`\\b${s}\\b`,"i").test(a)){t.includes(e)||t.push(e);break}}return[...new Set(t)]}extractFilterValue(e){console.log("\u{1f50d} Extraindo valor de:",e);let t=e.replace(/^(?:mostre|mostra|ver|exiba|exibir|quero\s+ver|show|display|filtre|filtrar|filter)\s+/i,"").replace(/^(?:apenas|somente|s\xf3|only|just)\s+/i,"").replace(/^(?:as|os|a|o|das|dos|da|do|the)\s+/i,"").replace(/\s+(?:as|os|a|o|das|dos|da|do|the)\s+/gi," ").replace(/categoria\s*|category\s*/gi,"").replace(/[?!.,;]+/g,"").replace(/\s+/g," ").trim();return console.log("\u2705 Valor extra\xeddo:",t),t.length>0?t:null}cleanCategoryName(e){console.log("\u{1f9f9} Limpando categoria:",e);let t=e.replace(/^(?:as|os|a|o|das|dos|da|do|the)\s+/gi,"").replace(/\s+(?:as|os|a|o|das|dos|da|do|the)\s+/gi," ").replace(/^(?:mostre|mostra|ver|exiba|filtre|filtrar|show|display|filter)\s+/i,"").replace(/^(?:apenas|somente|s\xf3|only|just)\s+/i,"").replace(/categoria\s*|category\s*/gi,"").replace(/[?!.,;:]+/g,"").replace(/\s+/g," ").trim();return console.log("\u2705 Categoria limpa:",t),t}normalizeCategoryName(e){const t=e.toLowerCase().trim();console.log("\u{1f50d} Normalizando categoria:",t);const a={"visita tecnica":"Visita","visitas tecnicas":"Visita","visita t\xe9cnica":"Visita","visitas t\xe9cnicas":"Visita",visitas:"Visita",visita:"Visita","technical visit":"Visita","technical visits":"Visita",visit:"Visita",visits:"Visita","oficina tematica":"Oficina","oficinas tematicas":"Oficina","oficina tem\xe1tica":"Oficina","oficinas tem\xe1ticas":"Oficina",oficinas:"Oficina",oficina:"Oficina",workshop:"Oficina",workshops:"Oficina",conferencias:"Confer\xeancia",conferencia:"Confer\xeancia",confer\u00eancias:"Confer\xeancia",conference:"Confer\xeancia",conferences:"Confer\xeancia",seminarios:"Semin\xe1rio",seminario:"Semin\xe1rio",semin\u00e1rios:"Semin\xe1rio",seminar:"Semin\xe1rio",seminars:"Semin\xe1rio",exposicoes:"Exposi\xe7\xe3o",exposicao:"Exposi\xe7\xe3o",exposi\u00e7\u00f5es:"Exposi\xe7\xe3o",exposi\u00e7\u00e3o:"Exposi\xe7\xe3o",exhibition:"Exposi\xe7\xe3o",exhibitions:"Exposi\xe7\xe3o",palestra:"Palestra",palestras:"Palestra",lecture:"Palestra",lectures:"Palestra",reuniao:"Reuni\xe3o",reunioes:"Reuni\xe3o",reuni\u00f5es:"Reuni\xe3o",reuni\u00e3o:"Reuni\xe3o",meeting:"Reuni\xe3o",meetings:"Reuni\xe3o",plenaria:"Plen\xe1ria",plenarias:"Plen\xe1ria",plen\u00e1rias:"Plen\xe1ria",plenary:"Plen\xe1ria"};if(a[t]){const o=a[t];return console.log(`\u{1f504} Mapeado: "${e}" \u2192 "${o}"`),o}const o=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();return console.log(`\u{1f4dd} Capitalizado: "${o}"`),o}getGreetingMessage(){const e=(new Date).getHours();let t="pt-BR"===this.language?"Ol\xe1":"Hello";return t=e<12?"pt-BR"===this.language?"Bom dia":"Good morning":e<18?"pt-BR"===this.language?"Boa tarde":"Good afternoon":"pt-BR"===this.language?"Boa noite":"Good evening","pt-BR"===this.language?`${t}! \u{1f44b}\n\nSou seu **Assistente Democr\xe1tico** de Participa\xe7\xe3o Social.\n\n**\u{1f4ac} Fale naturalmente:**\n\u2022 "Mostre oficinas e visitas"\n\u2022 "Qual p\xfablico total das exposi\xe7\xf5es?"\n\u2022 "Reuni\xf5es ou palestras"\n\nComo posso ajudar? \u{1f60a}`:`${t}! \u{1f44b}\n\nI'm your **Democratic Assistant** for Social Participation.\n\n**\u{1f4ac} Talk naturally:**\n\u2022 "Show workshops and visits"\n\u2022 "What's the total audience for exhibitions?"\n\u2022 "Meetings or lectures"\n\nHow can I help? \u{1f60a}`}getHelpMessage(){return"pt-BR"===this.language?'\u{1f4a1} **Guia R\xe1pido**\n\n**\u{1f50d} Filtrar:**\n\u2022 "Mostre as oficinas"\n\u2022 "Oficinas e visitas"\n\u2022 "Reuni\xf5es ou palestras"\n\n**\u{1f4ca} Calcular:**\n\u2022 "Qual o total de p\xfablico?"\n\u2022 "P\xfablico das palestras"\n\u2022 "Qual a m\xe9dia?"\n\u2022 "Maior p\xfablico"\n\n**\u{1f4cb} Listar:**\n\u2022 "Liste as categorias"\n\n**\u{1f5d1}\ufe0f Limpar:**\n\u2022 "Remover filtros"\n\nConverse naturalmente! \u{1f916}\u2728':'\u{1f4a1} **Quick Guide**\n\n**\u{1f50d} Filter:**\n\u2022 "Show workshops"\n\u2022 "Workshops and visits"\n\u2022 "Meetings or lectures"\n\n**\u{1f4ca} Calculate:**\n\u2022 "What\'s the total audience?"\n\u2022 "Audience for lectures"\n\u2022 "What\'s the average?"\n\u2022 "Largest audience"\n\n**\u{1f4cb} List:**\n\u2022 "List categories"\n\n**\u{1f5d1}\ufe0f Clear:**\n\u2022 "Remove filters"\n\nTalk naturally! \u{1f916}\u2728'}}var n=function(e,t,a,o){return new(a||(a=Promise))((function(s,i){function n(e){try{l(o.next(e))}catch(e){i(e)}}function r(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(n,r)}l((o=o.apply(e,t||[])).next())}))};class r{constructor(e,t){this.layer=null,this.layerView=null,this.sumCache=new Map,this.countCache=new Map,this.currentFilter=null,this.filterCheckInterval=null,this.jimuMapView=e,this.initializeLayer()}queryWithRetry(e){return n(this,arguments,void 0,(function*(e,t=2){for(let a=0;a<t;a++)try{return yield e()}catch(e){if(console.warn(`\u26a0\ufe0f Tentativa ${a+1}/${t} falhou:`,e),a===t-1)throw e;yield new Promise((e=>setTimeout(e,1e3*(a+1))))}}))}initializeLayer(){return n(this,void 0,void 0,(function*(){try{const e=this.jimuMapView.view.map.allLayers.filter((e=>"feature"===e.type));e.length>0?(this.layer=e.getItemAt(0),console.log("\u2705 Camada encontrada:",this.layer.title),this.layerView=yield this.jimuMapView.view.whenLayerView(this.layer),console.log("\u2705 LayerView obtida"),this.configureLayerViewBehavior()):(console.warn("\u26a0\ufe0f Nenhuma FeatureLayer encontrada no mapa"),this.jimuMapView.dataSourceId&&(yield this.createLayerFromDataSource()))}catch(e){console.error("\u274c Erro ao inicializar layer:",e)}}))}configureLayerViewBehavior(){this.layerView&&this.layerView.watch("filter",(e=>{this.currentFilter&&(e&&e.where===this.currentFilter||requestAnimationFrame((()=>{this.layerView&&this.currentFilter&&(this.layerView.filter={where:this.currentFilter})})))}))}setupClickListener(){var e;(null===(e=this.jimuMapView)||void 0===e?void 0:e.view)&&this.jimuMapView.view.on("click",(e=>{this.currentFilter&&setTimeout((()=>{this.reapplyFilterIfNeeded()}),100)}))}reapplyFilterIfNeeded(){var e;if(!this.layerView||!this.currentFilter)return;(null===(e=this.layerView.filter)||void 0===e?void 0:e.where)!==this.currentFilter&&(console.log("\u{1f504} Reaplicando filtro ap\xf3s intera\xe7\xe3o..."),this.layerView.filter={where:this.currentFilter})}startFilterMonitoring(){this.filterCheckInterval&&clearInterval(this.filterCheckInterval),this.filterCheckInterval=setInterval((()=>{this.reapplyFilterIfNeeded()}),500)}stopFilterMonitoring(){this.filterCheckInterval&&(clearInterval(this.filterCheckInterval),this.filterCheckInterval=null)}createLayerFromDataSource(){return n(this,void 0,void 0,(function*(){try{const[e]=yield(0,t.loadArcGISJSAPIModules)(["esri/layers/FeatureLayer"]),a=this.jimuMapView.getMapDataSource();if(a){const t=a.url;t&&(this.layer=new e({url:t}),this.jimuMapView.view.map.add(this.layer),console.log("\u2705 Layer criada a partir do DataSource"),this.layerView=yield this.jimuMapView.view.whenLayerView(this.layer),this.setupClickListener())}}catch(e){console.error("\u274c Erro ao criar layer do DataSource:",e)}}))}getLayerInfo(){var e,t;return this.layer?{id:this.layer.id,title:this.layer.title||"Camada sem t\xedtulo",fields:this.layer.fields||[],featureCount:(null===(t=null===(e=this.layer.capabilities)||void 0===e?void 0:e.query)||void 0===t?void 0:t.supportsPagination)?-1:0,geometryType:this.layer.geometryType,url:this.layer.url}:null}applyFilter(e){return n(this,void 0,void 0,(function*(){if(this.layerView)try{this.currentFilter=e,this.layerView.filter={where:e},console.log("\u2705 Filtro aplicado:",e),this.startFilterMonitoring(),this.sumCache.clear(),this.countCache.clear()}catch(e){console.error("\u274c Erro ao aplicar filtro:",e)}else console.error("\u274c LayerView n\xe3o dispon\xedvel")}))}clearFilter(){return n(this,void 0,void 0,(function*(){this.layerView&&(this.currentFilter=null,this.stopFilterMonitoring(),this.layerView.filter=null,console.log("\u2705 Filtros removidos"),this.sumCache.clear(),this.countCache.clear())}))}countFeatures(){return n(this,arguments,void 0,(function*(e="1=1"){if(!this.layer)return 0;const a=e,o=this.countCache.get(a);if(o&&Date.now()-o.timestamp<3e4)return console.log("\u2705 Usando contagem em cache:",o.value),o.value;console.log("\u{1f522} Contando features com where:",e);const s=Date.now();try{const[o]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]),i=yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new o({where:e,returnGeometry:!1});return yield this.layer.queryFeatureCount(t)})))),r=Date.now()-s;return console.log(`\u2705 Total de features: ${i} (${r}ms)`),this.countCache.set(a,{value:i,timestamp:Date.now()}),i}catch(o){console.error("\u274c Erro ao contar features:",o);try{console.log("\u{1f504} Tentando fallback de contagem...");const[o]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]),s=(yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new o({where:e,returnGeometry:!1,outFields:["objectid"],num:5e3});return yield this.layer.queryFeatures(t)}))))).features.length;return console.log("\u2705 Contagem por fallback:",s),this.countCache.set(a,{value:s,timestamp:Date.now()}),s}catch(e){return console.error("\u274c Fallback de contagem falhou:",e),0}}}))}getUniqueValues(e){return n(this,void 0,void 0,(function*(){if(!this.layer)return[];try{console.log("\u{1f50d} Buscando valores \xfanicos de:",e);const[a]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]);console.log("\u23f3 Executando query...");const o=Date.now(),s=yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new a({where:"1=1",returnDistinctValues:!0,returnGeometry:!1,outFields:[e],orderByFields:[e],num:100});return yield this.layer.queryFeatures(t)})))),i=Date.now()-o;console.log(`\u2705 Query executada em ${i}ms. Features: ${s.features.length}`);const r=s.features.map((t=>t.attributes[e])).filter((e=>null!=e&&""!==e)),l=[...new Set(r)];return console.log("\u{1f4ca} Valores \xfanicos encontrados:",l.length),l}catch(t){console.error("\u274c Erro ao obter valores \xfanicos:",t);try{return console.log("\u{1f504} Tentando m\xe9todo alternativo..."),yield this.getUniqueValuesAlternative(e)}catch(e){return console.error("\u274c M\xe9todo alternativo tamb\xe9m falhou:",e),[]}}}))}getUniqueValuesAlternative(e){return n(this,void 0,void 0,(function*(){if(!this.layer)return[];try{const[a]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]),o=(yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new a({where:"1=1",outFields:[e],returnGeometry:!1,returnDistinctValues:!1,num:100,orderByFields:[`${e} ASC`]});return yield this.layer.queryFeatures(t)}))))).features.map((t=>t.attributes[e])).filter((e=>null!=e&&""!==e)),s=[...new Set(o)];return console.log("\u2705 M\xe9todo alternativo OK. Valores:",s.length),s.sort()}catch(e){return console.error("\u274c M\xe9todo alternativo falhou:",e),[]}}))}calculateSum(e){return n(this,arguments,void 0,(function*(e,a="1=1"){if(!this.layer)return 0;const o=`${e}:${a}`,s=this.sumCache.get(o);if(s&&Date.now()-s.timestamp<3e4)return console.log("\u2705 Usando soma em cache:",s.value),s.value;console.log("\u{1f522} Calculando soma do campo:",e),console.log("\u{1f4cc} Where clause:",a);const i=Date.now();try{const[s]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]);console.log("\u23f3 Executando query de soma com statistics...");const r=yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new s({where:a,returnGeometry:!1,outStatistics:[{onStatisticField:e,outStatisticFieldName:"sum_value",statisticType:"sum"}]});return yield this.layer.queryFeatures(t)})))),l=Date.now()-i;if(r.features.length>0){const e=r.features[0].attributes.sum_value||0;return console.log(`\u2705 Soma calculada via statistics: ${e} (${l}ms)`),this.sumCache.set(o,{value:e,timestamp:Date.now()}),e}return 0}catch(s){const r=Date.now()-i;console.error(`\u274c Erro ao calcular soma via statistics (${r}ms):`,s);try{console.log("\u{1f504} Tentando soma manual...");const[s]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]),i=yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new s({where:a,returnGeometry:!1,outFields:[e],num:5e3});return yield this.layer.queryFeatures(t)}))));console.log("\u2705 Features obtidas para soma manual:",i.features.length);const r=i.features.reduce(((t,a)=>{const o=a.attributes[e];return t+(parseFloat(o)||0)}),0);return console.log("\u2705 Soma manual calculada:",r),this.sumCache.set(o,{value:r,timestamp:Date.now()}),r}catch(e){return console.error("\u274c Soma manual tamb\xe9m falhou:",e),0}}}))}calculateAverage(e){return n(this,arguments,void 0,(function*(e,a="1=1"){if(!this.layer)return 0;console.log("\u{1f4ca} Calculando m\xe9dia do campo:",e);const o=Date.now();try{const[s]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]),i=yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new s({where:a,returnGeometry:!1,outStatistics:[{onStatisticField:e,outStatisticFieldName:"avg_value",statisticType:"avg"}]});return yield this.layer.queryFeatures(t)})))),r=Date.now()-o;if(i.features.length>0){const e=i.features[0].attributes.avg_value||0;return console.log(`\u2705 M\xe9dia calculada: ${e} (${r}ms)`),e}return 0}catch(e){return console.error("\u274c Erro ao calcular m\xe9dia:",e),0}}))}calculateMin(e){return n(this,arguments,void 0,(function*(e,a="1=1"){if(!this.layer)return 0;console.log("\u2b07\ufe0f Calculando m\xednimo do campo:",e);try{const[o]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]),s=yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new o({where:a,returnGeometry:!1,outStatistics:[{onStatisticField:e,outStatisticFieldName:"min_value",statisticType:"min"}]});return yield this.layer.queryFeatures(t)}))));if(s.features.length>0){const e=s.features[0].attributes.min_value||0;return console.log("\u2705 M\xednimo calculado:",e),e}return 0}catch(e){return console.error("\u274c Erro ao calcular m\xednimo:",e),0}}))}calculateMax(e){return n(this,arguments,void 0,(function*(e,a="1=1"){if(!this.layer)return 0;console.log("\u2b06\ufe0f Calculando m\xe1ximo do campo:",e);try{const[o]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]),s=yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new o({where:a,returnGeometry:!1,outStatistics:[{onStatisticField:e,outStatisticFieldName:"max_value",statisticType:"max"}]});return yield this.layer.queryFeatures(t)}))));if(s.features.length>0){const e=s.features[0].attributes.max_value||0;return console.log("\u2705 M\xe1ximo calculado:",e),e}return 0}catch(e){return console.error("\u274c Erro ao calcular m\xe1ximo:",e),0}}))}zoomToFilteredFeatures(e){return n(this,void 0,void 0,(function*(){if(this.layer&&this.jimuMapView.view)try{console.log("\u{1f50d} Aplicando zoom aos features filtrados...");const[a]=yield(0,t.loadArcGISJSAPIModules)(["esri/rest/support/Query"]),o=yield this.queryWithRetry((()=>n(this,void 0,void 0,(function*(){const t=new a({where:e,returnGeometry:!0,outSpatialReference:this.jimuMapView.view.spatialReference});return yield this.layer.queryFeatures(t)}))));o.features.length>0?(yield this.jimuMapView.view.goTo(o.features,{duration:1e3}),console.log("\u2705 Zoom aplicado aos",o.features.length,"features filtrados")):console.warn("\u26a0\ufe0f Nenhum feature encontrado para zoom")}catch(e){console.error("\u274c Erro ao fazer zoom:",e)}}))}destroy(){this.stopFilterMonitoring(),this.sumCache.clear(),this.countCache.clear(),console.log("\u{1f9f9} LayerService destru\xeddo e recursos limpos")}}var l=function(e,t,a,o){return new(a||(a=Promise))((function(s,i){function n(e){try{l(o.next(e))}catch(e){i(e)}}function r(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(n,r)}l((o=o.apply(e,t||[])).next())}))};class c extends e.React.PureComponent{constructor(e){super(e),this.intervalId=null,this.retryCount=0,this.loadSavedAvatar=()=>{try{return localStorage.getItem("chat-widget-avatar")||"\u{1f468}\u{1f3fe}\u200d\u{1f4bc}"}catch(e){return"\u{1f468}\u{1f3fe}\u200d\u{1f4bc}"}},this.handleAvatarChange=e=>{console.log("\u{1f3ad} Avatar alterado para:",e);try{localStorage.setItem("chat-widget-avatar",e)}catch(e){console.warn("N\xe3o foi poss\xedvel salvar o avatar",e)}this.setState({selectedAvatar:e}),this.addBotMessage("pt-BR"===this.state.language?`\u2705 Avatar alterado com sucesso! ${e}`:`\u2705 Avatar changed successfully! ${e}`)},this.tryConnectToMap=()=>{console.log("\u{1f50d} Iniciando busca por mapa..."),this.intervalId=setInterval((()=>{if(this.retryCount++,this.retryCount>15)return console.error("\u274c Timeout: N\xe3o foi poss\xedvel conectar ao mapa ap\xf3s 30 segundos"),clearInterval(this.intervalId),void this.addBotMessage("\u274c N\xe3o consegui conectar ao mapa. Tente recarregar a p\xe1gina.");console.log(`\u{1f504} Tentativa ${this.retryCount}/15...`),this.state.jimuMapView?(console.log("\u2705 Conex\xe3o estabelecida, parando retry"),clearInterval(this.intervalId)):this.connectToMap()}),2e3)},this.connectToMap=()=>l(this,void 0,void 0,(function*(){try{console.log("\u{1f50d} Verificando MapViewManager...");const e=t.MapViewManager.getInstance();if(!e)return void console.warn("\u26a0\ufe0f MapViewManager n\xe3o dispon\xedvel ainda");console.log("\u2705 MapViewManager obtido");const a=e.getAllJimuMapViewIds();if(console.log("\u{1f4cb} IDs de mapas dispon\xedveis:",a),!a||0===a.length)return void console.warn("\u26a0\ufe0f Nenhum mapa encontrado ainda");console.log(`\u2705 Encontrados ${a.length} mapa(s)`);for(let t=0;t<a.length;t++){const o=a[t];console.log(`\u{1f50d} Tentando conectar ao mapa: ${o}`);const s=e.getJimuMapViewById(o);if(!s){console.warn(`\u26a0\ufe0f N\xe3o foi poss\xedvel obter JimuMapView para ${o}`);continue}if(console.log("\u2705 JimuMapView obtido:",s),!s.view){console.warn("\u26a0\ufe0f View ainda n\xe3o dispon\xedvel");continue}console.log("\u2705 View dispon\xedvel"),console.log("\u{1f4cd} View pronta:",s.view.ready),this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.setState({jimuMapView:s}),console.log("\u23f3 Aguardando view.when()..."),yield s.view.when(),console.log("\u2705 view.when() resolvido"),console.log("\u23f3 Aguardando layers carregarem..."),yield new Promise((e=>setTimeout(e,2e3))),console.log("\u{1f527} Criando LayerService...");const i=new r(s);return this.setState({layerService:i}),console.log("\u2705 LayerService criado e salvo no state"),console.log("\u{1f50d} Iniciando detec\xe7\xe3o de campos..."),void this.detectLayerFields(i)}}catch(e){console.error("\u274c Erro ao conectar:",e),console.error("Stack:",e.stack)}})),this.detectLayerFields=e=>l(this,void 0,void 0,(function*(){const t=e||this.state.layerService;if(!t)return void console.error("\u274c LayerService n\xe3o dispon\xedvel");console.log("\u{1f50d} Detectando campos da camada...");let a=0;const o=()=>l(this,void 0,void 0,(function*(){var e;console.log(`\u{1f504} Tentando detectar campos... Tentativa ${a+1}/5`);const s=t.getLayerInfo();if(console.log("\u{1f4ca} LayerInfo:",s),!s&&a<5)return a++,console.log("\u23f3 LayerInfo n\xe3o dispon\xedvel, tentando novamente em 2s..."),void setTimeout(o,2e3);if(!s)return console.error("\u274c N\xe3o foi poss\xedvel obter informa\xe7\xf5es da camada ap\xf3s todas as tentativas"),void this.setState((e=>({messages:[...e.messages.slice(0,-1),{id:Date.now().toString(),type:"bot",content:"pt-BR"===this.state.language?"\u274c N\xe3o consegui acessar os dados da camada. Verifique se h\xe1 uma camada v\xe1lida no mapa.":"\u274c Could not access layer data. Please check if there is a valid layer in the map.",timestamp:new Date}]})));if(console.log("\u2705 LayerInfo obtido com sucesso!"),console.log("\u{1f4ca} T\xedtulo da camada:",s.title),console.log("\u{1f4ca} Total de features:",s.featureCount),console.log("\u{1f4cb} Total de campos:",(null===(e=s.fields)||void 0===e?void 0:e.length)||0),s.fields&&s.fields.length>0){const e=s.fields.filter((e=>"oid"!==e.type&&"geometry"!==e.type)).map((e=>({name:e.name,alias:e.alias||e.name,type:e.type,domain:e.domain||null})));console.log("\u{1f4cb} Campos filtrados:",e.length),console.log("\u{1f4cb} Lista de campos:",e.map((e=>e.name)).join(", ")),this.setState({layerFields:e,isReady:!0}),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("\u2705\u2705\u2705 SISTEMA PRONTO! \u2705\u2705\u2705"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),this.setState((t=>({messages:[...t.messages.slice(0,-1),{id:Date.now().toString(),type:"bot",content:"pt-BR"===this.state.language?`\u2705 Conectado com sucesso!\n\n\u{1f4ca} **Camada:** ${s.title}\n\u{1f4cb} **Campos:** ${e.length}\n\n\u{1f4a1} **Experimente:**\n\u2022 "Liste as categorias"\n\u2022 "Mostre apenas oficinas"\n\u2022 "Qual o total?"\n\u2022 Clique no avatar para personaliz\xe1-lo!`:`\u2705 Successfully connected!\n\n\u{1f4ca} **Layer:** ${s.title}\n\u{1f4cb} **Fields:** ${e.length}\n\n\u{1f4a1} **Try:**\n\u2022 "List categories"\n\u2022 "Show only workshops"\n\u2022 "What's the total?"\n\u2022 Click on avatar to customize!`,timestamp:new Date}]})))}else console.warn("\u26a0\ufe0f Camada sem campos dispon\xedveis"),this.addBotMessage("pt-BR"===this.state.language?"\u26a0\ufe0f A camada n\xe3o possui campos dispon\xedveis.":"\u26a0\ufe0f The layer has no available fields.")}));o()})),this.addBotMessage=e=>{const t={id:Date.now().toString(),type:"bot",content:e,timestamp:new Date};this.setState((e=>({messages:[...e.messages,t]})))},this.handleLanguageChange=e=>{console.log("\u{1f310} Mudando idioma para:",e);const t="en-US"===e?"en":e;this.setState({language:t}),this.nlpService=new o(t);const a="pt-BR"===t?"\u2705 Idioma alterado para Portugu\xeas":"\u2705 Language changed to English";this.addBotMessage(a)},this.handleClearFilters=()=>l(this,void 0,void 0,(function*(){const{layerService:e,language:t}=this.state;e&&(console.log("\u{1f5d1}\ufe0f Limpando filtros..."),yield e.clearFilter(),this.setState({currentFilter:null}),this.addBotMessage("pt-BR"===t?"\u2705 Todos os filtros foram removidos!":"\u2705 All filters have been removed!"))})),this.handleSendMessage=e=>l(this,void 0,void 0,(function*(){var t;if(!this.state.isReady)return void this.addBotMessage("pt-BR"===this.state.language?"\u23f3 Aguarde, ainda estou me conectando ao mapa...":"\u23f3 Wait, I am still connecting to the map...");const a={id:Date.now().toString(),type:"user",content:e,timestamp:new Date};this.setState((e=>({messages:[...e.messages,a],isProcessing:!0})),(()=>{setTimeout((()=>{const e=document.querySelector("[data-messages-area]");e&&(e.scrollTop=e.scrollHeight)}),50)}));const o={id:(Date.now()+1).toString(),type:"bot",content:"pt-BR"===this.state.language?"\u23f3 Calculando... isso pode levar alguns segundos...":"\u23f3 Calculating... this may take a few seconds...",timestamp:new Date};this.setState((e=>({messages:[...e.messages,o]})),(()=>{setTimeout((()=>{const e=document.querySelector("[data-messages-area]");e&&(e.scrollTop=e.scrollHeight)}),50)}));try{const a=yield this.processQuery(e),o={id:(Date.now()+2).toString(),type:"bot",content:a.message,timestamp:new Date};this.setState((e=>({messages:[...e.messages.slice(0,-1),o],isProcessing:!1,currentFilter:a.filter||e.currentFilter})),(()=>{setTimeout((()=>{const e=document.querySelector("[data-messages-area]");e&&(e.scrollTop=e.scrollHeight)}),100)})),a.filter&&this.state.layerService&&(yield this.state.layerService.applyFilter(a.filter),(null===(t=this.state.jimuMapView)||void 0===t?void 0:t.view)&&(yield this.state.layerService.zoomToFilteredFeatures(a.filter)))}catch(e){console.error("\u274c Erro:",e),this.setState((e=>({messages:e.messages.slice(0,-1)}))),this.addBotMessage("pt-BR"===this.state.language?"\u274c Erro ao processar sua solicita\xe7\xe3o.":"\u274c Error processing your request."),this.setState({isProcessing:!1})}})),this.processQuery=e=>l(this,void 0,void 0,(function*(){const{layerFields:t,layerService:a}=this.state;if(!a)return{message:"pt-BR"===this.state.language?"\u274c Servi\xe7o n\xe3o dispon\xedvel":"\u274c Service not available",filter:null,data:null};const o=this.nlpService.analyzeIntent(e,t);switch(console.log("\u{1f3af} Intent final:",o),console.log("\u{1f50d} Intent type:",o.type),console.log("\u{1f50d} Intent params:",o.params),o.type){case"GREETING":return{message:this.nlpService.getGreetingMessage(),filter:null,data:null};case"HELP":return{message:this.nlpService.getHelpMessage(),filter:null,data:null};case"FILTER":return this.handleFilter(o);case"CALCULATE":return console.log("\u2705 Chamando handleCalculate..."),this.handleCalculate(o);case"CALCULATE_FILTERED":return this.handleCalculateFiltered(o);case"LIST":return this.handleList(o);case"RESET":return yield a.clearFilter(),this.setState({currentFilter:null}),{message:"pt-BR"===this.state.language?"\u2705 Pronto! Removi todos os filtros.\n\nAgora voc\xea est\xe1 vendo todos os eventos novamente. \u{1f5fa}\ufe0f":"\u2705 Done! I removed all filters.\n\nNow you are seeing all events again. \u{1f5fa}\ufe0f",filter:null,data:null};default:return console.log("\u26a0\ufe0f Intent n\xe3o reconhecido:",o.type),{message:this.nlpService.getHelpMessage(),filter:null,data:null}}})),this.removeAccents=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),this.generateVariations=e=>{const t=[];t.push(e),t.push(e.toLowerCase()),t.push(e.toUpperCase()),t.push(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase());const a=this.removeAccents(e);t.push(a.toLowerCase()),t.push(a.toUpperCase()),t.push(a.charAt(0).toUpperCase()+a.slice(1).toLowerCase());e.toLowerCase().replace(/a/g,"[a\xe1\xe0\xe3\xe2\xe4]").replace(/e/g,"[e\xe9\xe8\xea\xeb]").replace(/i/g,"[i\xed\xec\xee\xef]").replace(/o/g,"[o\xf3\xf2\xf5\xf4\xf6]").replace(/u/g,"[u\xfa\xf9\xfb\xfc]").replace(/c/g,"[c\xe7]").replace(/n/g,"[n\xf1]");return[...new Set(t)]},this.handleFilter=e=>l(this,void 0,void 0,(function*(){const{field:t,fieldAlias:a,value:o,values:s,operator:i="=",logicalOperator:n="OR"}=e.params,{layerService:r,language:l}=this.state;if(!r)return{message:"pt-BR"===l?"\u274c Servi\xe7o n\xe3o dispon\xedvel":"\u274c Service not available",filter:null,data:null};if("NOT_IN"===i&&s&&Array.isArray(s)&&s.length>0){console.log("\u{1f6ab} Iniciando filtro de EXCLUS\xc3O para:",s);const e=[];for(const a of s){const o=this.generateVariations(a).map((e=>`${t} LIKE '%${e}%'`)).join(" OR ");e.push(`(${o})`)}const a=`NOT (${e.join(" OR ")})`;console.log("\u{1f4cc} Where clause de exclus\xe3o gerado:",a);try{yield r.applyFilter(a);const e=yield r.countFeatures(a);if(0===e){return{message:"pt-BR"===l?`Hmm, ao excluir **"${s.join(" e ")}"** n\xe3o sobrou nada. \u{1f914}`:`Hmm, excluding **"${s.join(" and ")}"** left nothing. \u{1f914}`,filter:null,data:{count:0,field:t,values:s}}}const o="pt-BR"===l?" e ":" and ",i=s.join(o);return{message:"pt-BR"===l?`\u2728 **Filtro aplicado!**\n\n\u{1f6ab} Excluindo: **${i}**\n\u{1f4ca} Encontrados: **${e}** ${1===e?"evento":"eventos"}\n\n\u{1f4a1} Diga "limpar" para ver tudo novamente.`:`\u2728 **Filter applied!**\n\n\u{1f6ab} Excluding: **${i}**\n\u{1f4ca} Found: **${e}** ${1===e?"event":"events"}\n\n\u{1f4a1} Say "clear" to see everything again.`,filter:a,data:{count:e,field:t,values:s}}}catch(e){return console.error("\u274c Erro ao aplicar filtro de exclus\xe3o:",e),{message:"pt-BR"===l?"\u274c Desculpe, tive um problema ao excluir categorias.":"\u274c Sorry, I had a problem excluding categories.",filter:null,data:null}}}if(s&&Array.isArray(s)&&s.length>0){console.log("\u{1f50d} Iniciando filtro m\xfaltiplo para:",s);const e="AND"===n?" AND ":" OR ",a=s.map((e=>"("+this.generateVariations(e).map((e=>`${t} LIKE '%${e}%'`)).join(" OR ")+")")).join(e);console.log("\u{1f4cc} Where clause m\xfaltiplo gerado:",a);try{yield r.applyFilter(a);const e=yield r.countFeatures(a);if(0===e){return{message:"pt-BR"===l?`Hmm, n\xe3o encontrei nada para **"${s.join(" e ")}"**. \u{1f914}\n\n\u{1f4a1} Digite "liste as categorias" para ver todas as op\xe7\xf5es.`:`Hmm, I didn't find anything for **"${s.join(" and ")}"**. \u{1f914}\n\n\u{1f4a1} Type "list categories" to see all options.`,filter:null,data:{count:0,field:t,values:s}}}const o="pt-BR"===l?" e ":" and ",i=s.join(o);return{message:"pt-BR"===l?`\u2728 **Filtro aplicado!**\n\n\u{1f50d} Mostrando: **${i}**\n\u{1f4ca} Encontrados: **${e}** ${1===e?"evento":"eventos"}\n\n\u{1f4a1} Diga "limpar" para ver tudo novamente.`:`\u2728 **Filter applied!**\n\n\u{1f50d} Showing: **${i}**\n\u{1f4ca} Found: **${e}** ${1===e?"event":"events"}\n\n\u{1f4a1} Say "clear" to see everything again.`,filter:a,data:{count:e,field:t,values:s}}}catch(e){return console.error("\u274c Erro ao aplicar filtro m\xfaltiplo:",e),{message:"pt-BR"===l?"\u274c Desculpe, tive um problema ao filtrar.":"\u274c Sorry, I had a problem filtering.",filter:null,data:null}}}if(!o)return console.error("\u274c Valor de filtro n\xe3o fornecido"),{message:"pt-BR"===l?"\u274c N\xe3o consegui identificar o que filtrar.":"\u274c Could not identify what to filter.",filter:null,data:null};console.log("\u{1f50d} Iniciando filtro para:",o);let c="";if("LIKE"===i){const e=this.generateVariations(o);console.log("\u{1f50d} Varia\xe7\xf5es geradas:",e),c=e.map((e=>`${t} LIKE '%${e}%'`)).join(" OR ")}else c=`${t} = '${o}'`;console.log("\u{1f4cc} Where clause gerado:",c);try{yield r.applyFilter(c);const e=yield r.countFeatures(c);if(0===e){console.log("\u26a0\ufe0f Nenhum resultado, buscando sugest\xf5es...");const e=yield r.getUniqueValues(t),a=this.removeAccents(o.toLowerCase()),s=e.filter((e=>e&&this.removeAccents(e.toLowerCase()).includes(a))).slice(0,3);console.log("\u{1f4a1} Sugest\xf5es encontradas:",s);let i="pt-BR"===l?`Hmm, n\xe3o encontrei **"${o}"**. \u{1f914}\n\n`:`Hmm, I didn't find **"${o}"**. \u{1f914}\n\n`;return s.length>0?(i+="pt-BR"===l?"Talvez voc\xea quis dizer:\n":"Maybe you meant:\n",i+=s.map((e=>`\u2022 ${e}`)).join("\n")):i+="pt-BR"===l?'\u{1f4a1} Digite "liste as categorias" para ver todas as op\xe7\xf5es dispon\xedveis.':'\u{1f4a1} Type "list categories" to see all available options.',{message:i,filter:null,data:{count:0,field:t,value:o}}}return{message:"pt-BR"===l?`\u2728 **Filtro aplicado!**\n\n\u{1f50d} Mostrando apenas: **${o}**\n\u{1f4ca} Encontrados: **${e}** ${1===e?"evento":"eventos"}\n\n\u{1f4a1} Diga "limpar" para ver tudo novamente.`:`\u2728 **Filter applied!**\n\n\u{1f50d} Showing only: **${o}**\n\u{1f4ca} Found: **${e}** ${1===e?"event":"events"}\n\n\u{1f4a1} Say "clear" to see everything again.`,filter:c,data:{count:e,field:t,value:o}}}catch(e){return console.error("\u274c Erro ao aplicar filtro:",e),{message:"pt-BR"===l?`\u274c Desculpe, tive um problema ao filtrar por **"${o}"**.\n\nTente usar o nome exato ou liste as categorias primeiro.`:`\u274c Sorry, I had a problem filtering by **"${o}"**.\n\nTry using the exact name or list categories first.`,filter:null,data:null}}})),this.handleCalculate=e=>l(this,void 0,void 0,(function*(){const{operation:t,field:a,fieldAlias:o}=e.params,{layerService:s,currentFilter:i,language:n}=this.state;if(console.log("\u{1f4ca} handleCalculate chamado:",{type:e.type,operation:t,field:a,fieldAlias:o,hasFilter:!!e.params.filterValue}),!s)return{message:"pt-BR"===n?"\u274c Servi\xe7o n\xe3o dispon\xedvel":"\u274c Service not available",filter:null,data:null};let r=i||"1=1",l=!1;if("CALCULATE_FILTERED"===e.type){const{filterField:t,filterValue:a}=e.params;r=this.generateVariations(a).map((e=>`${t} LIKE '%${e}%'`)).join(" OR "),l=!0,console.log("\u{1f50d} Aplicando filtro de categoria:",r)}let c=0,d="",u="";console.log("\u{1f50d} Executando opera\xe7\xe3o:",t,"no campo:",a,"com WHERE:",r);const p=a.toLowerCase().includes("publico")||a.toLowerCase().includes("p\xfablico")||a.toLowerCase().includes("p_blico")||(null==o?void 0:o.toLowerCase().includes("publico"))||(null==o?void 0:o.toLowerCase().includes("p\xfablico"));switch(t){case"SUM":c=yield s.calculateSum(a,r),d="Total",u=p?"\u{1f465}":"\u{1f4b0}";break;case"AVG":c=yield s.calculateAverage(a,r),d="pt-BR"===n?"M\xe9dia":"Average",u=p?"\u{1f4ca}":"\u{1f4c8}";break;case"COUNT":c=yield s.countFeatures(r),d="pt-BR"===n?"Total de eventos":"Total events",u="\u{1f3af}";break;case"MIN":c=yield s.calculateMin(a,r),d="pt-BR"===n?"M\xednimo":"Minimum",u=p?"\u{1f464}":"\u2b07\ufe0f";break;case"MAX":c=yield s.calculateMax(a,r),d="pt-BR"===n?"M\xe1ximo":"Maximum",u=p?"\u{1f465}":"\u2b06\ufe0f"}console.log("\u2705 Resultado calculado:",c);const g=c.toLocaleString("pt-BR"===n?"pt-BR":"en-US",{maximumFractionDigits:0});let h="";if(p&&"SUM"===t)if(l){const t=e.params.filterValue;h="pt-BR"===n?`\u{1f465} **Total de P\xfablico nas ${t}s**: ${g} pessoas\n\n`:`\u{1f465} **Total Audience in ${t}s**: ${g} people\n\n`}else h="pt-BR"===n?`\u{1f465} **Total de P\xfablico**: ${g} pessoas\n\n`:`\u{1f465} **Total Audience**: ${g} people\n\n`;else h=p&&"AVG"===t?"pt-BR"===n?`\u{1f4ca} **M\xe9dia de P\xfablico**: ${g} pessoas por evento\n\n`:`\u{1f4ca} **Average Audience**: ${g} people per event\n\n`:p&&"MIN"===t?"pt-BR"===n?`\u{1f464} **Menor P\xfablico**: ${g} pessoas\n\n`:`\u{1f464} **Smallest Audience**: ${g} people\n\n`:p&&"MAX"===t?"pt-BR"===n?`\u{1f465} **Maior P\xfablico**: ${g} pessoas\n\n`:`\u{1f465} **Largest Audience**: ${g} people\n\n`:`${u} **${d}**: ${g}\n\n`;if(l){const t=e.params.filterValue;h+="pt-BR"===n?`\u{1f4cc} _Considerando apenas ${t}s_`:`\u{1f4cc} _Considering only ${t}s_`}else h+=i?"pt-BR"===n?"\u{1f4cc} _Considerando apenas os eventos filtrados_":"\u{1f4cc} _Considering only filtered events_":"pt-BR"===n?"\u{1f4cc} _Considerando todos os eventos_":"\u{1f4cc} _Considering all events_";return console.log("\u{1f4e8} Mensagem final:",h),{message:h,filter:l?r:i,data:{operation:t,field:a,result:c}}})),this.handleCalculateFiltered=e=>l(this,void 0,void 0,(function*(){const{operation:t,field:a,fieldAlias:o,filterField:s,filterValue:i}=e.params,{layerService:n,language:r}=this.state;if(!n)return{message:"pt-BR"===r?"\u274c Servi\xe7o n\xe3o dispon\xedvel":"\u274c Service not available",filter:null,data:null};console.log("\u{1f4ca} Calculando com filtro:",i);const l=`${s} LIKE '%${i}%'`;try{yield n.applyFilter(l);const e=yield n.calculateSum(a,l),o=yield n.countFeatures(l),s=e.toLocaleString("pt-BR"===r?"pt-BR":"en-US",{maximumFractionDigits:0});let c="pt-BR"===r?`\u{1f4ca} **P\xfablico total de "${i}"**\n\n\u{1f465} **${s}** pessoas\n\u{1f4cc} Em **${o}** ${1===o?"evento":"eventos"}\n\n\u{1f4a1} _Filtro mantido ativo_`:`\u{1f4ca} **Total audience for "${i}"**\n\n\u{1f465} **${s}** people\n\u{1f4cc} In **${o}** ${1===o?"event":"events"}\n\n\u{1f4a1} _Filter kept active_`;return this.setState({currentFilter:l}),{message:c,filter:l,data:{operation:t,field:a,result:e,filterValue:i}}}catch(e){return console.error("\u274c Erro:",e),{message:"pt-BR"===r?`\u274c N\xe3o consegui calcular o p\xfablico de "${i}"`:`\u274c Could not calculate audience for "${i}"`,filter:null,data:null}}})),this.handleList=e=>l(this,void 0,void 0,(function*(){const{field:t,fieldAlias:a}=e.params,{layerService:o,language:s}=this.state;if(console.log("\u{1f310} Idioma atual no handleList:",s),console.log("\u{1f310} Tipo do idioma:",typeof s),!o)return{message:"pt-BR"===s?"\u274c Servi\xe7o n\xe3o dispon\xedvel":"\u274c Service not available",filter:null,data:null};console.log("\u{1f4cb} Listando valores de:",t,"-",a),this.addBotMessage("pt-BR"===s?"\u23f3 Buscando valores... isso pode levar alguns segundos...":"\u23f3 Fetching values... this may take a few seconds...");try{const e=yield o.getUniqueValues(t);if(console.log("\u2705 Valores obtidos do banco:",e),0===e.length)return this.setState((e=>({messages:e.messages.slice(0,-1)}))),{message:"pt-BR"===s?`Hmm, n\xe3o consegui encontrar valores para **${a}**. \u{1f914}\n\nPode ser que o servidor esteja ocupado. Tente novamente em alguns segundos.`:`Hmm, couldn't find values for **${a}**. \u{1f914}\n\nThe server might be busy. Try again in a few seconds.`,filter:null,data:null};this.setState((e=>({messages:e.messages.slice(0,-1)}))),console.log("\u{1f504} Traduzindo para idioma:",s);const i=e.map((e=>{const t=this.translateCategory(e,s);return console.log(`  "${e}" \u2192 "${t}"`),t}));console.log("\u2705 Valores traduzidos:",i);const n=i.slice(0,15),r=i.length>15;let l="pt-BR"===s?`\u{1f4cb} **${a}** encontradas:\n\n`:`\u{1f4cb} **${a}** found:\n\n`;return l+=n.map(((e,t)=>`${this.getCategoryEmoji(e)} **${e}**`)).join("\n"),r&&(l+="pt-BR"===s?`\n\n_... e mais ${i.length-15} categorias_`:`\n\n_... and ${i.length-15} more categories_`),l+="pt-BR"===s?`\n\n\u{1f4a1} **Exemplo:** Diga "mostre apenas ${n[0]}"`:`\n\n\u{1f4a1} **Example:** Say "show only ${n[0]}"`,{message:l,filter:null,data:{field:t,values:i}}}catch(e){return console.error("\u274c Erro ao listar:",e),this.setState((e=>({messages:e.messages.slice(0,-1)}))),{message:"pt-BR"===s?'\u274c **Timeout!**\n\nO servidor est\xe1 demorando muito para responder.\n\n\u{1f4a1} **Tente:**\n\u2022 Aguardar alguns segundos\n\u2022 Usar filtros diretos: "mostre apenas oficinas"':'\u274c **Timeout!**\n\nThe server is taking too long to respond.\n\n\u{1f4a1} **Try:**\n\u2022 Wait a few seconds\n\u2022 Use direct filters: "show only workshops"',filter:null,data:null}}})),this.getCategoryEmoji=e=>{const t=e.toLowerCase();return t.includes("oficina")||t.includes("workshop")?"\u{1f528}":t.includes("confer\xeancia")||t.includes("conferencia")||t.includes("conference")?"\u{1f3a4}":t.includes("semin\xe1rio")||t.includes("seminario")||t.includes("seminar")?"\u{1f4da}":t.includes("palestra")||t.includes("lecture")?"\u{1f393}":t.includes("visita")||t.includes("visit")?"\u{1f441}\ufe0f":t.includes("reuni\xe3o")||t.includes("reuniao")||t.includes("meeting")?"\u{1f465}":t.includes("audi\xeancia")||t.includes("audiencia")||t.includes("hearing")?"\u2696\ufe0f":t.includes("consulta")||t.includes("consultation")?"\u{1f4ac}":t.includes("f\xf3rum")||t.includes("forum")?"\u{1f3db}\ufe0f":t.includes("exposi\xe7\xe3o")||t.includes("exposicao")||t.includes("exhibition")?"\u{1f3a8}":t.includes("plen\xe1ria")||t.includes("plenaria")||t.includes("plenary")?"\u{1f3db}\ufe0f":"\u{1f4cc}"};const a=this.loadSavedAvatar();this.state={messages:[{id:"1",type:"bot",content:"\u{1f50d} Procurando mapa dispon\xedvel...",timestamp:new Date}],isProcessing:!1,layerFields:[],currentFilter:null,layerService:null,isReady:!1,jimuMapView:null,language:"pt-BR",selectedAvatar:a},this.nlpService=new o("pt-BR")}componentDidMount(){console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("\u{1f916} WIDGET CHAT IA - INICIADO"),console.log("Props config:",this.props.config),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),setTimeout((()=>{this.tryConnectToMap()}),2e3)}componentWillUnmount(){this.intervalId&&clearInterval(this.intervalId)}translateCategory(e,t){if("en-US"===t||"en"===t){return{Oficina:"Workshop",Visita:"Visit",Reuni\u00e3o:"Meeting",Exposi\u00e7\u00e3o:"Exhibition",Plen\u00e1ria:"Plenary",Semin\u00e1rio:"Seminar",Palestra:"Lecture",Debate:"Debate",Confer\u00eancia:"Conference",Audi\u00eancia:"Hearing",Consulta:"Consultation",F\u00f3rum:"Forum",Curso:"Course",Encontro:"Meeting"}[e]||e}return e}render(){const{messages:t,isProcessing:o,currentFilter:s,language:i,selectedAvatar:n}=this.state;return(0,e.jsx)("div",{style:{width:"100%",height:"100%"}},(0,e.jsx)(a,{messages:t,isProcessing:o,onSendMessage:this.handleSendMessage,onClearFilters:this.handleClearFilters,hasActiveFilter:!!s,language:i,avatarType:"bot",theme:"dark",showSuggestions:!0,onLanguageChange:this.handleLanguageChange,selectedAvatar:n,onAvatarChange:this.handleAvatarChange}))}}function d(e){s.p=e}})(),i})())}}}));